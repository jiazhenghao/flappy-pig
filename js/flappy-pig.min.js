var flappy=function(n){"use strict";return n.option={g:400,v0:400,vp:2.5,frequency:20,levels:100,safeLift:500,floorHeight:64,pigWidth:33,pigHeight:30,pigY:300,pigLeft:80,pillarHtml:'<div class="top"><\/div><div class="bottom"><\/div>',pillarWidth:45,pillarGapY:108,pillarGapX:250,pillarTop:-550,pillarBottom:-500},n}(flappy||{}),flappy=function(n){"use strict";return n.util={preventDefaultEvent:function(n){n=window.event||n,n&&(n.preventDefault?n.preventDefault():n.returnValue=!1)},$:function(n){return document.getElementById(n)},getChilds:function(n){for(var i=n.children||n.childNodes,r=[],t=0,u=i.length;t<u;t++)i[t].nodeType==1&&r.push(i[t]);return r}},n}(flappy||{}),flappy=function(n){"use strict";var t=n.option,i=n.util.$;return n.pig={Y:0,init:function(n,r){var u=this;u.s=0,u.time=0,u.$pig=i("pig"),u.$pig.style.left=t.pigLeft+"px",u._controller=r,u._addListener(n)},_addListener:function(n){this._overCallback=n},start:function(){var n=this,i=t.frequency/1e3;n.s=t.v0*n.time-n.time*n.time*t.g*2,n.Y=t.pigY+n.s,n.Y>=t.floorHeight?n.$pig.style.bottom=n.Y+"px":n._dead(),n.time+=i},jump:function(){var n=this;t.pigY=parseInt(n.$pig.style.bottom),n.s=0,n.time=0},_dead:function(){this._overCallback.call(this._controller)},fall:function(){var n=this;n.Y=t.floorHeight,n.$pig.style.bottom=n.Y+"px"},hit:function(){var n=this,i=setInterval(function(){n.$pig.style.bottom=n.Y+"px",n.Y<=t.floorHeight&&clearInterval(i),n.Y-=12},t.frequency)}},n}(flappy||{}),flappy=function(n){"use strict";var t=n.option,i=n.util,r=i.$;return n.pillar={currentId:-1,init:function(){var n=this;n._factor=t.pillarBottom-t.pillarGapY+450,n._s=t.pigLeft+t.pigWidth+10,n._render()},_render:function(){var u=this,o=t.safeLift,f,s,n;for(u.left=0,u.dom=document.createElement("div"),u.dom.className=u.dom.id="pillarWrapper",f=0,s=t.levels;f<s;f++){n=document.createElement("div"),n.innerHTML=t.pillarHtml,n.className="pillar",n.id="pillar-"+f,n.style.left=o+"px";var h=i.getChilds(n),c=h[0],l=h[1],e=u._random(f);c.style.top=e.top+"px",l.style.bottom=e.bottom+"px",n.setAttribute("top",600+e.top),n.setAttribute("bottom",0-e.bottom),u.dom.appendChild(n),o+=t.pillarGapX}r("screen").appendChild(u.dom)},_random:function(n){var r=this,u=Math.random(),i=Math.abs(Math.sin(n*u))*290;return{top:t.pillarTop+i,bottom:r._factor-i}},move:function(){var n=this;n.dom.style.left=-n.left+"px",n._find(n.left),n.left+=t.vp},_find:function(n){var i=this,r=(i._s+n-t.safeLift)/t.pillarGapX,u=parseInt(r);r>0&&i.currentId!=u&&Math.abs(r-u)<.1&&(i.currentId=u)}},n}(flappy||{}),flappy=function(n){"use strict";var u=n.pig,i=n.pillar,t=n.option,r=n.util.$;return n.position={init:function(n,i){var u=this;u.pillarWrapper=r("pillarWrapper"),u.pigX1=t.pigLeft,u.pigX2=t.pigLeft+t.pigWidth,u._controller=i,u._addListener(n)},_addListener:function(n){this._overCallback=n},judge:function(){var n=this,f=r("pillar-"+i.currentId);i.currentId!=-1&&(n.pigY2=600-u.Y,n.pigY1=n.pigY2-t.pigHeight,n.pY1=f.getAttribute("top"),n.pY2=f.getAttribute("bottom"),n.pX1=parseInt(f.style.left)+parseInt(n.pillarWrapper.style.left),n.pX2=n.pX1+t.pillarWidth,t.pigLeft+t.pigWidth>=n.pX1&&t.pigLeft<=n.pX2&&(n.pigY1<n.pY1||n.pigY2>n.pY2)&&n._dead())},_dead:function(){this._overCallback.call(this._controller)}},n}(flappy||{}),flappy=function(n){"use strict";var t=n.pig,i=n.pillar,u=n.position,f=n.util,r=f.$,e=n.option;return n.controller={init:function(){var n=this;n._isStart=!1,n._timer=null,t.init(n.fall,n),i.init(),u.init(n.hit,n),n.addKeyListener()},addKeyListener:function(){var n=this;document.onkeydown=function(t){var t=t||event,i=t.keyCode||t.which||t.charCode;i==32&&(n.jump(),f.preventDefaultEvent(t))}},jump:function(){var n=this;n._isStart?t.jump():(r("begin").style.display="none",n._createTimer(function(){t.start(),i.move(),u.judge(),r("score").innerHTML=i.currentId+1}),n._isStart=!0)},hit:function(){var n=this;n.over(),t.hit()},fall:function(){var n=this;n.over(),t.fall()},over:function(){var n=this;clearInterval(n._timer),r("end").style.display="block"},_createTimer:function(n){var t=this;t._timer=setInterval(n,e.frequency)}},n}(flappy||{}),flappy=function(n){"use strict";var o=n.controller,f=n.option,t=n.pig,i=n.pillar,u=n.position,e=n.util,r=n.util.$;return n.game={init:function(){var n=this;n._isStart=!1,n._isEnd=!1,n._timer=null,t.init(n.fall,n),i.init(),u.init(n.hit,n),n.addKeyListener()},addKeyListener:function(){var n=this;document.onkeydown=function(t){var t=t||event,i=t.keyCode||t.which||t.charCode;i==32&&(n._isEnd?window.location.reload():n.jump(),e.preventDefaultEvent(t))}},jump:function(){var n=this;n._isStart?t.jump():(r("start").style.display="none",n._createTimer(function(){t.start(),i.move(),u.judge(),r("score").innerHTML=i.currentId+1}),n._isStart=!0)},hit:function(){var n=this;n.over(),t.hit()},fall:function(){var n=this;n.over(),t.fall()},over:function(){var n=this;clearInterval(n._timer),n._isEnd=!0,r("end").style.display="block"},_createTimer:function(n){var t=this;t._timer=setInterval(n,f.frequency)}},flappy.init=function(){n.game.init()},n}(flappy||{})